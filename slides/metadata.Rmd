---

---

## What is Metadata?

Metadata is the information needed for someone else to understand and use your data.  It is the Who, What, When, Where, Why, and How about your data.  

This includes _package-level_ and _file-level_ metadata.  

===

### Common components of metadata

Package-level:
 - Data creator 
 - Geographic and temporal extents of data (generally)
 - Funding source
 - Licensing information (Creative Commons, etc.)
 - Publication date

===

File-level:
 - Define variable names
 - Describe variables (units, etc.)
 - Define allowed values for a variable
 - Describe file formats

===

### Metadata Standards

The goal is to have a machine and human readable description of your data. 
 
Metadata standards create a structural expression of metadata necessary to document a data set.  
This can mean using a controlled set of descriptors for your data specified by the standard. 

===

Without metadata standards, your digital data may be irretrievable, unidentifiable or unusable. 
Metadata standards contain definitions of the data elements and standardized ways of representing them in digital formats such as databases and XML (eXtensible Markup Language).
{:.notes}

These standards ensure consistent structure that facilitates data sharing and searching, record provenance and technical processes, and manage access permissions.  Recording metadata in digital formats such as XML ensures effective machine searches through consistent structured data entry, and thesauri using controlled vocabularies.  
{:.notes}

Metadata standards are often developed by user communities.  

For example, the Ecological Metadata Language, EML, is a standard developed by ecologists to document environmental and ecological data. EML is a set of XML schema documents that allow for the structural expression of metadata. To learn more about EML check out their [site](https://eml.ecoinformatics.org).
{:.notes}

Therefore, the standards can vary between disciplines and types of data.  

===

![]({% include asset.html path="images/standards_xkcd.png" %}){: width="75%"} 

===

Some examples include:

   - General: [Dublin Core](http://dublincore.org/)
   - Ecological/Environmental/Biological: [EML](https://www.dcc.ac.uk/resources/metadata-standards/eml-ecological-metadata-language), [Darwin Core](https://dwc.tdwg.org/)
   - Social science: [DDI](http://www.ddialliance.org/), [EAD](https://www.loc.gov/ead/) 
   - Geospatial/Meterological/Oceanographic: [ISO 19115](https://www.iso.org/standard/53798.html), [COARDS Conventions](https://ferret.pmel.noaa.gov/Ferret/documentation/coards-netcdf-conventions)

===

### Creating metadata

Employer-specific mandated methods (ex: USGS)

===

Repository-specific methods

Repository websites frequently guide you through metadata creation during the process of uploading your data.  
{:.notes}

   - website for metadata entry on the [Knowledge Network for Biocomplexity](https://knb.ecoinformatics.org) repository 
     ![]({% include asset.html path="images/knb_snap.PNG" %}){: width="100%"} 
     

     
===     
   
Stand-alone software

Software designed for data curation often has more features and options.  This software from the [Queensland Cyber Infratstructure Foundation](https://www.qcif.edu.au/) supports metadata creation, provenance, and data packaging.    
{:.notes}
   
   - [Data Curator](https://github.com/qcif/data-curator)
     ![]({% include asset.html path="images/Data_Curator_snap.PNG" %}){: width="100%"} 
     
===

Coding 

Many methods for documenting and packaging data are also available in R packages developed by repository managers.  For example, `EMLassemblyline` was developed by the [Environmental Data Initiative](https://environmentaldatainitiative.org/) to facilitate documenting data in EML, and preparing data for publication.          
{:.notes}

   - R packages ([EML](){:.rlib}, [dataspice](https://github.com/ropenscilabs/dataspice), [emld](){:.rlib}),
   [EMLassemblyline](https://ediorg.github.io/EMLassemblyline/)
 
===

### Example of coding up some metadata  

| R Package   | What does it do?                                           |
|-------------+------------------------------------------------------------|
| `dataspice` | creates metadata files in json-ld format                   |
| `emld`      | aids conversion of metadata files between EML and json-ld  |
| `EML`       | creates EML metadata files                                 |
| `jsonlite`  | reads json and json-ld file formats in R                   |

===

We'll use the [dataspice](https://github.com/ropenscilabs/dataspice) package to create metadata in the EML metadata standard. 

```{r, eval = FALSE, message = FALSE, handout = 0}
library(dataspice) 
```

===

Create data package templates.

```{r, eval = FALSE, handout = 0}
create_spice(dir = "storm_project")
```
 
Look at your storm_project folder, and see the CSV template files. 
 
=== 

### Describe the package-level metadata. 
 
The templates are empty, so now we need to populate them. 
Add extent, coverage, license, publication, funder, keywords, etc. 

===

We can get the temporal and geographic extent information using the `range()` function. 

```{r, eval = FALSE}
range(stm_dat$YEAR)

range(stm_dat$BEGIN_LAT, na.rm=TRUE)
range(stm_dat$BEGIN_LON, na.rm=TRUE)
```
  
===  
  
This extent information can now be added to the `biblio.csv` metadata file.  

This function opens a Shiny app interface where you can enter and save information in the CSV templates.  You could also edit these CSV files in another software program.
{:.notes}

```{r, eval = FALSE, handout = 0}
edit_biblio(metadata_dir = "storm_project/metadata")
```

You may need to click the stop sign in your console to stop the edit Shiny app interface.
{:.notes}

===

Describe the creators of the data. 

```{r, eval = FALSE, handout = 0}
edit_creators(metadata_dir = "storm_project/metadata")
```

You may need to click the stop sign in your console to stop the edit Shiny app interface.
{:.notes}

===

The `prep_access()` function tries to discover the metadata for itself.  

```{r, eval = FALSE, handout = 0}
prep_access(data_path = "storm_project",
            access_path = "storm_project/metadata/access.csv")
```
  
=== 

The `edit_access()` function can be used to edit the generated metadata, or used by itself to manually enter access metadata.  Supply the file name and other access information about the data.

```{r, eval = FALSE, handout = 0}
edit_access(metadata_dir = "storm_project/metadata")
```

===

### Describe the file-level metadata.

The `prep_attributes()` function tries also to discover the metadata for itself.  

```{r, eval = FALSE, handout = 0}
prep_attributes(data_path = "storm_project",
                attributes_path = "storm_project/metadata/attributes.csv")  
```
  
===  
  
The `edit_attributes()` function can be used to further edit the file attribute metadata.    
  
```{r, eval = FALSE, handout = 0}
edit_attributes(metadata_dir = "storm_project/metadata")
```

===

### Write metadata file

Now we can write our metadata to a json-ld file.

```{r, eval = FALSE, handout = 0}
write_spice(path = "storm_project/metadata")
```

===

You can also create a static website for your dataset.

```{r, eval = FALSE, warning = FALSE, handout = 0}
build_site(path = "storm_project/metadata/dataspice.json")
```

Your site will build to the location "docs/index.html".
{:.notes}

===

Many repositories use EML (Ecological Metadata Language) formatting for metadata.  
Now convert the json-ld file into EML format.

```{r, eval = FALSE, message = FALSE, handout = 0}
library(emld) 
library(EML) 
library(jsonlite)

json <- read_json("storm_project/metadata/dataspice.json")
eml <- as_emld(json)  
write_eml(eml, "storm_project/metadata/dataspice.xml")
```

===
